"on":
  schedule:
    - cron: 0 12 * * *
  workflow_dispatch: {}
name: Update
jobs:
  update:
    runs-on: ubuntu-latest
    # These steps should be kept in sync with `update_dry_run.yml` - minus the code that
    # actually commits, pushes and creates a PR.
    steps:
      - uses: actions/checkout@2541b1294d2704b0964813337f33b291d3f8596b # tag=v3
      - uses: actions/setup-node@eeb10cff27034e7acf239c5d29f62154018672fd # tag=v3
        with:
          cache: npm
          node-version: 16
      - run: npm ci
      - run: npm run download
      - uses: actions/checkout@2541b1294d2704b0964813337f33b291d3f8596b # tag=v3
        with:
          repository: xuorig/anicca
          path: anicca
      - uses: actions-rs/toolchain@16499b5e05bf2e26879000db0c1d13f7e13fa3af # tag=v1
        with:
          toolchain: stable
      - run: cargo build
        working-directory: anicca
      - run: npm run build
      - run: rm -rf anicca
      - name: update cache
        uses: gr2m/create-or-update-pull-request-action@v1.x
        env:
          GITHUB_TOKEN: ${{ secrets.OCTOKITBOT_PAT }}
        with:
          title: ðŸ¤–ðŸ“¯ GitHub OpenAPI Update
          body: >
            I found new changes in [GitHub's official OpenAPI
            specifications](https://github.com/github/rest-api-description) and
            thought I'd let you know about it ðŸ‘‹ðŸ¤–


            I can't tell if the changes include fixes, features, breaking
            changes or just cache updates, you'll have to figure that out on
            yourself and adapt the commit messages accordingly to trigger the
            right release, see [our commit message
            conventions](https://github.com/octokit/openapi/blob/main/CONTRIBUTING.md#merging-the-pull-request--releasing-a-new-version).
          branch: update
          author: Octokit Bot <octokitbot@martynus.net>
          commit-message: "WIP: schema updates"
          labels: maintenance
